<div align="center">

<img src="assets/logo.svg" alt="JD Invoice Auto-Merge" width="700">

<br/>
<br/>

**äº¬ä¸œå‘ç¥¨è‡ªåŠ¨æ¢å¼€/åˆå¼€å·¥å…·**

*åŸºäº Frida åŠ¨æ€æ³¨å…¥ + Chrome DevTools Protocol æ“æ§ App å†… WebView*

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![Python 3.10+](https://img.shields.io/badge/Python-3.10+-blue.svg)](https://www.python.org/)
[![Frida](https://img.shields.io/badge/Frida-17.x-orange.svg)](https://frida.re/)
[![Platform](https://img.shields.io/badge/Platform-Android-green.svg)]()

</div>

---

## æ¦‚è¿°

`jd-invoice-merge` ä¸æ˜¯ç®€å•çš„çˆ¬è™«æˆ–æ¨¡æ‹Ÿç‚¹å‡»å·¥å…·ã€‚å®ƒé€šè¿‡ **Frida åŠ¨æ€æ³¨å…¥** å¼€å¯äº¬ä¸œ App è‡ªç ” D6 Chromium WebView çš„è°ƒè¯•ç«¯å£ï¼Œå†ç»ç”± **Chrome DevTools Protocol (CDP)** ç›´æ¥æ“æ§é¡µé¢å†…çš„ **Vue.js ç»„ä»¶å®ä¾‹**ï¼Œç»•è¿‡ native bridge è®¤è¯é™åˆ¶ï¼Œå®ç°å…¨è‡ªåŠ¨çš„å‘ç¥¨åˆå¹¶æ¢å¼€ã€‚

> **ä»…ä¾›æŠ€æœ¯å­¦ä¹ ä¸ç ”ç©¶ã€‚** è¯·éµå®ˆäº¬ä¸œå¹³å°æœåŠ¡æ¡æ¬¾åŠç›¸å…³æ³•å¾‹æ³•è§„ã€‚

### åŠŸèƒ½ç‰¹æ€§

- **æ•°æ®é‡‡é›†** -- è‡ªåŠ¨ç¿»é¡µåŠ è½½å‘ç¥¨ä¸­å¿ƒå…¨éƒ¨è®¢å•ï¼Œæ”¯æŒæ¢å¼€ tab å’Œå…¨éƒ¨ tab ä¸¤ç§æ¨¡å¼
- **æ™ºèƒ½è§„åˆ’** -- æŒ‰å¼€ç¥¨æœºæ„ (orgId) åˆ†ç»„ï¼Œè´ªå¿ƒæœç´¢æœ€ä¼˜ç»„åˆï¼Œæ¯å¼ å‘ç¥¨ >= Â¥100 ä¸”å°½é‡ç´§å‡‘
- **æ‰¹é‡æ‰§è¡Œ** -- é€å¼ æäº¤åˆå¼€è¯·æ±‚ï¼Œéšæœºå»¶è¿Ÿ + å¤±è´¥é‡è¯• + æ–­ç‚¹ç»­ä¼ 
- **å•ç‹¬æ¢å¼€** -- å¯¹ä¸åœ¨åˆå¼€åˆ—è¡¨ä¸­çš„å¤§é¢è®¢å•ï¼Œé€šè¿‡ `goodsCard.jumpToHk()` è‡ªåŠ¨å•ç‹¬æ¢å¼€

---

## æŠ€æœ¯æ¶æ„

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚           Python è„šæœ¬å±‚               â”‚
                    â”‚                                      â”‚
                    â”‚  fetch_orders  optimize  batch_merge  â”‚
                    â”‚       â”‚            â”‚          â”‚       â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚         core/ å…¬å…±æ¨¡å—           â”‚  â”‚
                    â”‚  â”‚  bridge  cdp  connection config â”‚  â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚            â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚  Frida    â”‚  â”‚  CDP WebSocket       â”‚
                     â”‚  17.x    â”‚  â”‚  Runtime.evaluate()   â”‚
                     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚               â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                                            â”‚
              â”‚   äº¬ä¸œ App  (com.jingdong.app.mall)         â”‚
              â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
              â”‚   â”‚  D6 Chromium WebView             â”‚     â”‚
              â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚
              â”‚   â”‚  â”‚  Vue.js å‘ç¥¨ä¸­å¿ƒé¡µé¢        â”‚  â”‚     â”‚
              â”‚   â”‚  â”‚                            â”‚  â”‚     â”‚
              â”‚   â”‚  â”‚  OrderList                 â”‚  â”‚     â”‚
              â”‚   â”‚  â”‚  â”œâ”€â”€ InfiniteScroll        â”‚  â”‚     â”‚
              â”‚   â”‚  â”‚  â”œâ”€â”€ goodsCard[]           â”‚  â”‚     â”‚
              â”‚   â”‚  â”‚  â””â”€â”€ HksAppIvcTitle (è¡¨å•)  â”‚  â”‚     â”‚
              â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
              â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥ HTTP å‘åŒ…ï¼Ÿ

äº¬ä¸œå‘ç¥¨ä¸­å¿ƒçš„ API è®¤è¯èµ° **native bridge**ï¼Œè€Œéæ ‡å‡† cookie/tokenï¼š

```
é¡µé¢ JS  -->  JD SDK (JDBridge)  -->  åŸç”Ÿ App ç½‘ç»œå±‚  -->  æ³¨å…¥è®¤è¯å¤´  -->  HTTP è¯·æ±‚
```

Python ç›´æ¥å‘ HTTP è¯·æ±‚ç¼ºå°‘åŸç”Ÿå±‚æ³¨å…¥çš„è®¤è¯ä¿¡æ¯ï¼ŒæœåŠ¡ç«¯è¿”å› **401**ã€‚æœ¬å·¥å…·çš„è§£æ³•ï¼šé€šè¿‡ CDP åœ¨é¡µé¢ä¸Šä¸‹æ–‡ä¸­æ‰§è¡Œ JSï¼Œå€ŸåŠ©é¡µé¢è‡ªèº«çš„ SDK å®Œæˆè®¤è¯ã€‚

---

## é¡¹ç›®ç»“æ„

```
jd-invoice-merge/
â”‚
â”œâ”€â”€ core/                        # å…¬å…±æ¨¡å—
â”‚   â”œâ”€â”€ bridge.py                # Frida 17.x Java bridge åŠ è½½ + D6 WebView è°ƒè¯•
â”‚   â”œâ”€â”€ cdp.py                   # CDP WebSocket é€šä¿¡ã€JS æ‰§è¡Œã€ç«¯å£è½¬å‘
â”‚   â”œâ”€â”€ connection.py            # Frida + CDP ç”Ÿå‘½å‘¨æœŸç®¡ç† (async context manager)
â”‚   â””â”€â”€ config.py                # é…ç½®æ–‡ä»¶åŠ è½½ä¸é»˜è®¤å€¼åˆå¹¶
â”‚
â”œâ”€â”€ scripts/                     # åŠŸèƒ½è„šæœ¬
â”‚   â”œâ”€â”€ fetch_orders.py          # é‡‡é›†è®¢å•æ•°æ® (æ¢å¼€ tab + å…¨éƒ¨ tab)
â”‚   â”œâ”€â”€ optimize.py              # æœ€ä¼˜åˆå¼€ç»„åˆç®—æ³•
â”‚   â”œâ”€â”€ batch_merge.py           # æ‰¹é‡åˆå¼€æ‰§è¡Œ (å«é‡è¯•ã€æ–­ç‚¹ç»­ä¼ )
â”‚   â””â”€â”€ batch_single_hk.py      # æ‰¹é‡å•ç‹¬æ¢å¼€ (å…¨éƒ¨ tab å¤§é¢è®¢å•)
â”‚
â”œâ”€â”€ data/                        # è¿è¡Œæ—¶æ•°æ® (å·² gitignore)
â”œâ”€â”€ config.example.json          # é…ç½®æ–‡ä»¶æ¨¡æ¿
â”œâ”€â”€ requirements.txt             # Python ä¾èµ–
â””â”€â”€ LICENSE
```

---

## ç¯å¢ƒå‡†å¤‡

### Frida æ˜¯ä»€ä¹ˆï¼Ÿ

[Frida](https://frida.re/) æ˜¯ä¸€ä¸ªåŠ¨æ€äºŒè¿›åˆ¶æ’æ¡©æ¡†æ¶ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶å‘ App è¿›ç¨‹æ³¨å…¥ JavaScript ä»£ç ã€‚æœ¬é¡¹ç›®ç”¨å®ƒæ¥å¼€å¯äº¬ä¸œ App å†… WebView çš„è°ƒè¯•å¼€å…³ï¼ˆè¯¥å¼€å…³åœ¨æ­£å¼ç‰ˆä¸­æ˜¯å…³é—­çš„ï¼‰ã€‚

æ•´ä¸ªé“¾è·¯æ˜¯è¿™æ ·çš„ï¼š

```
ä½ çš„ç”µè„‘                              æ‰‹æœº (å·² root)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    USB/ADB     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Python     â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚  frida-server (åå°è¿è¡Œ)   â”‚
â”‚  + frida    â”‚                â”‚       â”‚                   â”‚
â”‚             â”‚                â”‚       â–¼                   â”‚
â”‚  è„šæœ¬è¿è¡Œ    â”‚                â”‚  æ³¨å…¥ JS åˆ°äº¬ä¸œ App è¿›ç¨‹    â”‚
â”‚             â”‚                â”‚       â”‚                   â”‚
â”‚             â”‚                â”‚       â–¼                   â”‚
â”‚             â”‚   CDP/WS       â”‚  å¼€å¯ D6 WebView è°ƒè¯•ç«¯å£  â”‚
â”‚             â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚       â”‚                   â”‚
â”‚             â”‚                â”‚       â–¼                   â”‚
â”‚  æ“æ§ Vue   â”‚                â”‚  å‘ç¥¨ä¸­å¿ƒ H5 é¡µé¢           â”‚
â”‚  ç»„ä»¶å®ä¾‹    â”‚                â”‚  (Vue.js)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å®‰è£… Fridaï¼ˆè¯¦ç»†æ­¥éª¤ï¼‰

**1. ç”µè„‘ç«¯å®‰è£… Python åŒ…ï¼š**

```bash
pip install frida frida-tools
```

å®‰è£…å®Œæˆåç¡®è®¤ç‰ˆæœ¬ï¼š

```bash
frida --version
# è¾“å‡ºç±»ä¼¼: 17.0.5
```

**2. æ‰‹æœºç«¯å®‰è£… frida-serverï¼š**

åˆ° [Frida Releases](https://github.com/frida/frida/releases) ä¸‹è½½ä¸ä½  **Python frida åŒ…ç‰ˆæœ¬ä¸€è‡´** çš„ frida-serverã€‚

> ç‰ˆæœ¬å¿…é¡»å®Œå…¨åŒ¹é…ï¼æ¯”å¦‚ç”µè„‘ç«¯ `frida==17.0.5`ï¼Œæ‰‹æœºç«¯å°±è¦ä¸‹è½½ `frida-server-17.0.5-android-arm64.xz`ã€‚

```bash
# æŸ¥çœ‹æ‰‹æœºæ¶æ„
adb shell getprop ro.product.cpu.abi
# å¸¸è§è¾“å‡º: arm64-v8a

# è§£å‹å¹¶æ¨é€åˆ°æ‰‹æœº
xz -d frida-server-17.0.5-android-arm64.xz
adb push frida-server-17.0.5-android-arm64 /data/local/tmp/frida-server
adb shell "chmod 755 /data/local/tmp/frida-server"
```

**3. å¯åŠ¨ frida-serverï¼š**

```bash
adb shell "su -c /data/local/tmp/frida-server &"
```

**4. éªŒè¯è¿æ¥ï¼š**

```bash
frida-ps -U | grep jingdong
# åº”è¯¥èƒ½çœ‹åˆ°: com.jingdong.app.mall
```

> å¦‚æœ `frida-ps -U` æŠ¥é”™ "unable to connect to remote frida-server"ï¼Œæ£€æŸ¥ï¼šæ‰‹æœºæ˜¯å¦å·² rootã€frida-server æ˜¯å¦åœ¨è¿è¡Œã€ç‰ˆæœ¬æ˜¯å¦åŒ¹é…ã€‚

### å…¶ä»–ç¯å¢ƒè¦æ±‚

| è¦æ±‚ | è¯´æ˜ |
|:---|:---|
| Python | >= 3.10 |
| æ‰‹æœº | å·² rootï¼ŒUSB è°ƒè¯•å·²å¼€å¯ |
| ADB | å·²è¿æ¥æ‰‹æœºï¼ˆ`adb devices` èƒ½çœ‹åˆ°è®¾å¤‡ï¼‰ |
| äº¬ä¸œ App | å·²ç™»å½•ï¼Œå·²æ‰“å¼€å‘ç¥¨ä¸­å¿ƒé¡µé¢ |

### å®‰è£…æœ¬é¡¹ç›®

```bash
git clone https://github.com/yourname/jd-invoice-merge.git
cd jd-invoice-merge
pip install -r requirements.txt
```

---

## é…ç½®

```bash
cp config.example.json config.json
```

ç¼–è¾‘ `config.json`ï¼Œå¡«å…¥ä½ çš„å‘ç¥¨æŠ¬å¤´ä¿¡æ¯ï¼š

```json
{
  "invoice": {
    "ivc_title": "ä½ çš„å§“å",
    "ivc_title_type": 4,
    "ivc_type": 3,
    "ivc_content": 1,
    "change_reason": "æŠ¬å¤´æœ‰è¯¯"
  }
}
```

<details>
<summary><b>å®Œæ•´é…ç½®å‚è€ƒ</b></summary>

| å­—æ®µ | é»˜è®¤å€¼ | è¯´æ˜ |
|:---|:---|:---|
| `invoice.ivc_title` | `""` | å‘ç¥¨æŠ¬å¤´ï¼ˆä½ çš„å§“åæˆ–å…¬å¸åï¼‰ |
| `invoice.ivc_title_type` | `4` | 4 = ä¸ªäººï¼Œ2 = ä¼ä¸š |
| `invoice.ivc_type` | `3` | 3 = ç”µå­æ™®é€šå‘ç¥¨ |
| `invoice.ivc_content` | `1` | 1 = å•†å“æ˜ç»† |
| `invoice.change_reason` | `"æŠ¬å¤´æœ‰è¯¯"` | æ¢å¼€åŸå›  |
| `merge.target_amount` | `100.0` | æ¯å¼ åˆå¼€å‘ç¥¨çš„æœ€ä½é‡‘é¢ |
| `merge.max_orders_per_invoice` | `10` | å•å¼ å‘ç¥¨æœ€å¤šåˆå¹¶çš„è®¢å•æ•° |
| `execution.delay_min` / `delay_max` | `4` / `9` | æ¯å¼ å‘ç¥¨é—´çš„éšæœºå»¶è¿Ÿï¼ˆç§’ï¼‰ |
| `execution.retry_limit` | `2` | å¤±è´¥é‡è¯•æ¬¡æ•° |

</details>

---

## ä½¿ç”¨æ–¹æ³•

**ç¬¬ 1 æ­¥** -- ç¡®ä¿ frida-server åœ¨æ‰‹æœºä¸Šè¿è¡Œï¼ˆå‚è§ä¸Šæ–¹å®‰è£…æ­¥éª¤ï¼‰

**ç¬¬ 2 æ­¥** -- æ‰“å¼€äº¬ä¸œ App -> æˆ‘çš„ -> å®¢æˆ·æœåŠ¡ -> å‘ç¥¨æœåŠ¡

**ç¬¬ 3 æ­¥** -- é‡‡é›†è®¢å•æ•°æ®ï¼š

```bash
python -m scripts.fetch_orders
```

**ç¬¬ 4 æ­¥** -- ç”Ÿæˆæœ€ä¼˜åˆå¼€è®¡åˆ’ï¼š

```bash
python -m scripts.optimize
```

<details>
<summary>è¾“å‡ºç¤ºä¾‹</summary>

```
MERGE PLAN: N invoices, M orders, Â¥xxxx.xx
Avg waste per invoice: Â¥x.xx

Invoice 1: orgId=544 | 3 orders | Â¥100.07 (waste Â¥0.07)
    xxxxxxxxxx  Â¥49.90
    xxxxxxxxxx  Â¥29.90
    xxxxxxxxxx  Â¥20.27
...
```

</details>

**ç¬¬ 5 æ­¥** -- æ‰¹é‡æ‰§è¡Œåˆå¼€ï¼š

```bash
python -m scripts.batch_merge
```

**ç¬¬ 6 æ­¥** *(å¯é€‰)* -- å¯¹å¤§é¢è®¢å•å•ç‹¬æ¢å¼€ï¼š

```bash
python -m scripts.batch_single_hk
```

---

## åˆå¼€ç®—æ³•

### é—®é¢˜å®šä¹‰

ç»™å®šåŒä¸€ `orgId`ï¼ˆå¼€ç¥¨æœºæ„ï¼‰ä¸‹çš„ *N* ä¸ªè®¢å•ï¼Œæ¯ä¸ªè®¢å•é‡‘é¢ä¸º *a_i*ï¼Œå°†å®ƒä»¬åˆ’åˆ†ä¸º **å°½å¯èƒ½å¤šçš„å­é›†**ï¼Œä½¿æ¯ä¸ªå­é›†çš„é‡‘é¢ä¹‹å’Œ >= Â¥100ã€‚

### ç®—æ³•æ€è·¯

```
å¯¹æ¯ä¸ª orgId åˆ†ç»„:
    pool = æŒ‰é‡‘é¢é™åºæ’åˆ—çš„è®¢å•
    while sum(pool) >= ç›®æ ‡é‡‘é¢:
        for size in [2, 3, ..., max_size]:
            åœ¨ pool ä¸­æ‰¾ size ä¸ªè®¢å•çš„ç»„åˆï¼Œä½¿ sum æœ€æ¥è¿‘ç›®æ ‡é‡‘é¢ï¼ˆä¸” >= ç›®æ ‡ï¼‰
            if æ‰¾åˆ°ä¸” sum < ç›®æ ‡ * 1.10:
                break  // è¶³å¤Ÿç´§å‡‘ï¼Œä¸å†æœç´¢æ›´å¤§ size
        è®°å½•è¯¥ç»„åˆä¸ºä¸€å¼ å‘ç¥¨
        ä» pool ä¸­ç§»é™¤å·²ç”¨è®¢å•
```

**å‰ªæç­–ç•¥ï¼š**
- **Top-k æ£€æŸ¥**ï¼šå¦‚æœæœ€å¤§çš„ k ä¸ªè®¢å•ä¹‹å’Œ < ç›®æ ‡é‡‘é¢ï¼Œè·³è¿‡ size=k
- **Bottom-k æ£€æŸ¥**ï¼šå¦‚æœæœ€å°çš„ k ä¸ªè®¢å•ä¹‹å’Œ >= å½“å‰æœ€ä¼˜è§£ï¼Œè·³è¿‡ size=k
- **æå‰ç»ˆæ­¢**ï¼šæ‰¾åˆ°çš„ç»„åˆé‡‘é¢åœ¨ç›®æ ‡çš„ 110% ä»¥å†…ï¼Œä¸å†æœç´¢æ›´å¤§ç»„åˆ

---

## æŠ€æœ¯ç»†èŠ‚

### Frida 17.x Java Bridge é—®é¢˜

Frida ä» 17.x ç‰ˆæœ¬å¼€å§‹ï¼Œå°† Java bridge ä»æ ¸å¿ƒè¿è¡Œæ—¶ä¸­è§£è€¦ã€‚è¿™æ„å‘³ç€ç›´æ¥åœ¨æ³¨å…¥è„šæœ¬ä¸­è°ƒç”¨ `Java.perform()` ä¼šæŠ›å‡ºï¼š

```
ReferenceError: Java is not defined
```

**åŸå› **ï¼šFrida 17.x ä¸å†è‡ªåŠ¨åŠ è½½ Java bridgeï¼Œéœ€è¦æ‰‹åŠ¨å¼•å…¥ã€‚

**æœ¬é¡¹ç›®çš„è§£å†³æ–¹æ¡ˆ**ï¼ˆè§ [`core/bridge.py`](core/bridge.py)ï¼‰ï¼š

```python
# 1. æ‰¾åˆ° frida-tools è‡ªå¸¦çš„ Java bridge æ–‡ä»¶
bridge_path = os.path.join(
    os.path.dirname(frida_tools.__file__), 'bridges', 'java.js'
)

# 2. è¯»å– bridge ä»£ç ï¼Œå°† bridge å¯¹è±¡ç»‘å®šåˆ° globalThis.Java
bridge_code += "Object.defineProperty(globalThis, 'Java', { value: bridge });"

# 3. å°† bridge ä»£ç å’Œç”¨æˆ·è„šæœ¬æ‰“åŒ…æˆ Frida å¯æ‰§è¡Œçš„æ ¼å¼
#    æ ¼å¼: ğŸ“¦\n{size} /frida/repl-{n}.js\nâœ„\n{code}
```

æ‰“åŒ…åçš„è„šæœ¬é€šè¿‡ `session.create_script()` åŠ è½½ï¼ŒJava bridge å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ã€‚

### D6 Chromium WebView

äº¬ä¸œ App ä½¿ç”¨è‡ªç ” **D6 Chromium** å†…æ ¸ï¼ˆ`libd6webviewchromium.so`ï¼‰ï¼Œä¸æ˜¯æ ‡å‡† Android WebViewã€‚å…³é”®åŒºåˆ«ï¼š

| å¯¹æ¯”é¡¹ | æ ‡å‡† Android WebView | äº¬ä¸œ D6 Chromium |
|:---|:---|:---|
| è°ƒè¯•å¼€å…³ | `WebView.setWebContentsDebuggingEnabled()` | `XWebView.enableWebContentsDebug()` |
| DevTools Socket | `webview_devtools_remote_{pid}` | `dong_webview_devtools_remote_{pid}` |
| å¼•æ“ | ç³»ç»Ÿ Chromium | å†…ç½® D6 Chromium |

é€šè¿‡ Frida æ‰¾åˆ° `XWebView` å®ä¾‹å¹¶è°ƒç”¨ `enableWebContentsDebug(true)` åï¼Œå°±å¯ä»¥ç”¨æ ‡å‡† CDP åè®®è¿æ¥äº†ï¼š

```bash
# ADB ç«¯å£è½¬å‘
adb forward tcp:9444 localabstract:dong_webview_devtools_remote_{pid}

# æŸ¥çœ‹å¯è°ƒè¯•é¡µé¢
curl http://localhost:9444/json
```

### Vue ç»„ä»¶ç›´æ¥æ“æ§

å‘ç¥¨ä¸­å¿ƒé¡µé¢åŸºäº Vue.jsã€‚é€šè¿‡ `element.__vue__` è®¿é—®ç»„ä»¶å®ä¾‹ï¼Œç›´æ¥è°ƒç”¨å†…éƒ¨æ–¹æ³•ï¼š

```javascript
// è§¦å‘åˆ†é¡µåŠ è½½ï¼ˆèµ° native bridge è®¤è¯ï¼Œç»•è¿‡ 401 é—®é¢˜ï¼‰
infiniteScroll.$emit('load')

// æ³¨å…¥è®¢å•æ•°æ®å¹¶æäº¤åˆå¼€è¯·æ±‚
vm.commitBatchHkfpReq(orders)

// æœåŠ¡ç«¯æ ¡éªŒé€šè¿‡åï¼Œç¡®è®¤åˆå¹¶
vm.submitMerge()
```

è¿™æ¯” DOM æ¨¡æ‹Ÿç‚¹å‡»æ›´å¯é  -- ä¸ä¾èµ– CSS é€‰æ‹©å™¨ã€ä¸å—é¡µé¢å¸ƒå±€å˜åŒ–å½±å“ã€‚

---

## å…è´£å£°æ˜

æœ¬é¡¹ç›®ä»…ä¾›æŠ€æœ¯å­¦ä¹ å’Œç ”ç©¶ç›®çš„ã€‚ä½¿ç”¨è€…åº”è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨é£é™©ï¼Œéµå®ˆäº¬ä¸œå¹³å°çš„æœåŠ¡æ¡æ¬¾å’Œç›¸å…³æ³•å¾‹æ³•è§„ã€‚ä½œè€…ä¸å¯¹å› ä½¿ç”¨æœ¬å·¥å…·é€ æˆçš„ä»»ä½•åæœè´Ÿè´£ã€‚

---

<div align="center">

åŸºäº [Frida](https://frida.re/) + [Chrome DevTools Protocol](https://chromedevtools.github.io/devtools-protocol/) + [Vue.js](https://vuejs.org/) å†…éƒ¨æœºåˆ¶æ„å»º

</div>
